var assetsPath = 'assets/images/';
var three = require('three');

var texturesData = [
	'icon_boy.png',
	'icon_cat.png',
	'icon_dog.png',
	'icon_girl.png',
	'icon_wife.png'
];

var textures = {};

var ready;


var texturesToLoad = texturesData.length;
function onSuccess() {
	texturesToLoad--;
	if(texturesToLoad === 0) {
		ready();
	}
}

function onError() {
	throw new Error('Nope!');
}

function getSprite(fileName) {
	var geometry = new three.PlaneGeometry(1, 1);
	var texture = textures[fileName];
	var material = new three.MeshBasicMaterial({
		map: texture,
		transparent: true,
		depthTest: false
	});
	var mesh = new three.Mesh(geometry, material);
	mesh.scale.set(texture.image.width, texture.image.height, 1);
	return mesh;
}

function init(callback) {
	ready = callback;
	texturesData.forEach(function(fileName) {
		var texture = three.ImageUtils.loadTexture(
			assetsPath + fileName,
			undefined,
			onSuccess,
			onError
		);
		textures[fileName] = texture;
	});
}

module.exports = {
	getSprite:getSprite,
	init: init
};
