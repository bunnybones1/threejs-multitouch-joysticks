var initd = false;
var physics = require('physics');

var Seeker = require('./SeekerPoint');
var Elephant = require('./Elephant');

var world = require('world');
var view = require('view');
function init() {
	if(initd) return;
	initd = true;

	var scene = world.scene;

	var elephant = new Elephant();
	physics.setAvatar(elephant);

	var seeker = new Seeker({
		targetBody: elephant.body
	});

	var pos, elephantPos;
	var delta = new physics.Box2D.b2Vec2(0, 0);
	function preRender() {
		pos = seeker.body.GetPosition();
		elephantPos = elephant.body.GetPosition();
		var posX = pos.get_x();
		var posY = pos.get_y();
		var deltaX = posX - elephantPos.get_x();
		var deltaY = posY - elephantPos.get_y();
		var x = posX - deltaX * 2;
		var y = posY - deltaY * 2;
		view.setCameraCenter(x * physics.SCALE_INV, y * physics.SCALE_INV);
	}
	exports.preRender = preRender;

	delete exports.init;
}

var exports = {
	init: init
};

module.exports = exports;