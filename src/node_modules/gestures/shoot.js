var three = require('three');
var world = require('world');
var view = require('view');

var ball;
var shootGesture = {
	touches: 1,
	name: 'shoot',

	onStart: onStart,
	onMove: onMove,
	onEnd: onEnd,
}

function onStart(touches) {
	console.log('external shoot start', touches.length);
	var x = touches[0].clientX;
	var y = view.height - touches[0].clientY;
	if(!ball) {
		ball = new three.Mesh(new three.SphereGeometry(50, 32, 16));
	}
	if(!ball.parent) {
		world.scene.add(ball);
	}
	ball.position.set(x, y, 0);
}

function onMove(touches) {
	console.log('external shoot move', touches.length);
	var x = touches[0].clientX;
	var y = view.height - touches[0].clientY;
	ball.position.set(x, y, 0);
}

function onEnd(touches) {
	console.log('external shoot end', touches.length);
	var x = touches[0].clientX;
	var y = view.height - touches[0].clientY;
	if(ball.parent) {
		world.scene.remove(ball);
	}
	ball.position.set(x, y, 0);
}

module.exports = shootGesture;