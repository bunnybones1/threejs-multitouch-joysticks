require('polyfills')();
var debugging = require('debugging');
var canvas = require('canvas');
var world = require('world');
var view = require('view');
var input = require('input');
var gestures = require('gestures');
var physics = require('physics');
var gameObjects = require('game-objects');
var game = require('game');
var scenery = require('scenery');
var Sound = require('sound');

function main() {
	canvas.init();
	world.init();
	view.init();
	input.init();
	gestures.init();
	physics.init();
	gameObjects.init();
	game.init();
	scenery.init();
	Sound.init();
	view.setPreRender(preRender);
	view.setOnEnterFrame(onEnterFrame);
	startLoop();



	// gestures.shoot.setCallback(gameObjects.elephant.fireArrow);
}

function preRender() {
	view.setCameraBounds(gameObjects.hero.getSightBounds());
	scenery.preRender();
}

function onEnterFrame() {
	gestures.onEnterFrame();
}

function startLoop() { 
	Sound.play('bg', 'Heartbeat');
}

function stopLoop() { 
	Sound.stop('bg', 'Heartbeat');
}

module.exports = main;